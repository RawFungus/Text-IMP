# Text IMP v1.18.5

**Text IMP** — это скрипт для импорта и обновления текстовых слоёв в Adobe After Effects из JSON-файла или напрямую в проекте. Он предоставляет удобный интерфейс для управления текстовыми слоями, их экспорта в JSON и обновления на основе внешних данных.

---

## Возможности
- Импорт текстовых данных из JSON-файла.
- Экспорт текстовых слоёв из проекта в JSON-файл.
- Обновление текстовых слоёв в проекте на основе импортированных данных JSON.
- Фильтрация слоёв для исключения тех, у которых есть выражения.
- Поиск конкретных слоёв по имени или содержимому.
- Редактирование текстовых слоёв прямо из интерфейса.
- Фокусировка на конкретных слоях в таймлайне.
- **Редактирование JSON-файлов с помощью инструмента на Python.**

---

## Требования
- **Adobe After Effects** с поддержкой Legacy ExtendScript (JavaScript).
- Совместимость с Windows и macOS.
- **Python 3.x** для инструмента редактирования JSON.

---

## Установка
1. Скачайте файл скрипта `Text IMP v1.18.5.jsx`.
2. Поместите файл в место, доступное для Adobe After Effects.
3. Откройте Adobe After Effects.
4. Перейдите в меню `Файл > Скрипты > Выполнить файл скрипта...` и выберите скрипт.
5. (Опционально) Установите Python 3.x для использования инструмента редактирования JSON.

---

## Как использовать

### 1. Запуск скрипта
Запустите скрипт через меню `Файл > Скрипты > Выполнить файл скрипта...` в Adobe After Effects. Появится пользовательский интерфейс.

### 2. Обзор интерфейса
Интерфейс разделён на несколько панелей:
- **Работа с файлами**: Импорт/экспорт JSON-файлов и обновление текстовых слоёв.
- **Управление слоями**: Просмотр, фильтрация и поиск текстовых слоёв.
- **Редактирование текста**: Редактирование текста выбранных слоёв.
- **Управление таймлайном**: Настройка позиции таймлайна для выбранных слоёв.
- **Логирование**: Просмотр логов выполненных операций.

---

### 3. Импорт текстовых данных
1. Нажмите кнопку **"Выбрать файл"** в панели "Работа с файлами".
2. Выберите JSON-файл с текстовыми данными.
3. Имя файла отобразится, а данные будут загружены в список слоёв.

### 4. Экспорт текстовых слоёв
1. Нажмите кнопку **⬇** в панели "Работа с файлами".
2. Выберите место для сохранения JSON-файла.
3. Скрипт экспортирует все текстовые слои из проекта в файл.

### 5. Обновление текстовых слоёв
1. Импортируйте JSON-файл с обновлёнными текстовыми данными.
2. Нажмите кнопку **"Обновить текст из файла"**.
3. Скрипт обновит текстовые слои в проекте на основе импортированных данных.

---

### 6. Управление слоями
- **Фильтрация слоёв**: Используйте выпадающее меню, чтобы показать все слои или исключить те, у которых есть выражения.
- **Поиск слоёв**: Введите запрос для фильтрации списка слоёв.
- **Обновление списка слоёв**: Нажмите кнопку **"Обновить список слоёв"**, чтобы перезагрузить слои из проекта.

---

### 7. Редактирование текста слоя
1. Выберите слой из списка.
2. Отредактируйте текст в панели "Редактирование текста слоя".
3. Нажмите кнопку **"Сохранить"**, чтобы применить изменения.

---

### 8. Фокусировка на слоях
1. Выберите слой из списка.
2. Нажмите кнопку **"Показать слой"**.
3. Скрипт перейдёт к слою на таймлайне и сделает его видимым.

---

### 9. Управление таймлайном
- **Начало слоя**: Фокусировка на начальной точке слоя.
- **Середина слоя**: Фокусировка на середине слоя.

---

### 10. Логирование
- Просматривайте логи всех операций в панели "Логирование".
- Нажмите кнопку **"Очистить логи"**, чтобы очистить лог.

---

### 11. Редактирование JSON-файлов с помощью Python
1. Запустите Python-скрипт `IMP_JSON_GUI.py` с помощью Python 3.x.
2. Используйте графический интерфейс для открытия, редактирования и сохранения JSON-файлов.
3. Возможности инструмента:
   - Просмотр композиций и слоёв в древовидной структуре.
   - Редактирование текстового содержимого слоёв.
   - Удаление слоёв или композиций.
   - Сохранение изменений обратно в JSON-файл.

---

## Формат JSON-файла
JSON-файл должен содержать массив объектов со следующей структурой:
```json
[
    {
        "compName": "Имя композиции",
        "layerIndex": 1,
        "layerName": "Имя слоя",
        "text": "Новое текстовое содержимое"
    }
]
```

---

## Устранение неполадок
- **Ошибка: "Слой не найден"**: Убедитесь, что композиция и индекс слоя в JSON-файле соответствуют проекту.
- **Ошибка: "Ошибка парсинга JSON"**: Проверьте, что JSON-файл правильно отформатирован.
- **Не удаётся обновить текст**: Проверьте, редактируемо ли свойство "Source Text" слоя.

---

## Автор
**RawFungus**  
GitHub: [https://github.com/RawFungus](https://github.com/RawFungus)

---

## Лицензия
This project is licensed under the GNU General Public License v3.0 - see the LICENSE file for details.
